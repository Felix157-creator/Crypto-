<!DOCTYPE html>
<html>
<head>
  <title>Deposit</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="card">
  <h2>Deposit Funds (USD)</h2>

  <input id="amount" type="number" placeholder="Amount in USD" />

  <select id="method">
    <option value="mpesa">MPesa</option>
    <option value="airtel">Airtel Money</option>
    <option value="bank">Bank Transfer</option>
    <option value="card">Card</option>
    <option value="crypto">Crypto</option>
  </select>

  <button onclick="deposit()">Proceed to Payment</button>
</div>

<script>
async function deposit() {
  const amount = document.getElementById("amount").value;
  const method = document.getElementById("method").value;

  if (!amount || amount <= 0) return alert("Enter amount");

  const res = await fetch("/api/start-deposit", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      userId: localStorage.userId,
      amount,
      method
    })
  });

  const data = await res.json();
  if (data.payment_url) window.location.href = data.payment_url;
  else alert("Payment error");
}
</script>

</body>
</html>
